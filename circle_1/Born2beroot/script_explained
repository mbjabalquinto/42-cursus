ğŸ”¹ Shebang
#!/bin/bash


Indica que el script debe ejecutarse usando Bash.
Es obligatorio para que el sistema sepa quÃ© intÃ©rprete usar.

ğŸ§± ARQUITECTURA
arch=$(uname -a)


uname -a: muestra informaciÃ³n completa del sistema

kernel

arquitectura

versiÃ³n

Se guarda en la variable arch

ğŸ“Œ Ejemplo:

Linux debian 5.10.0-21-amd64 x86_64 GNU/Linux

ğŸ–¥ï¸ CPU FÃSICA
cpuf=$(grep "physical id" /proc/cpuinfo | wc -l)


/proc/cpuinfo: informaciÃ³n del CPU

grep "physical id": identifica CPUs fÃ­sicas

wc -l: cuenta lÃ­neas â†’ nÃºmero de CPUs fÃ­sicas

ğŸ“Œ En una VM suele ser 1

âš™ï¸ CPU VIRTUAL
cpuv=$(grep "processor" /proc/cpuinfo | wc -l)


Cuenta los procesadores lÃ³gicos

Incluye cores e hilos

ğŸ“Œ En una VM suele coincidir con los vCPU asignados

ğŸ§  MEMORIA RAM
ram_total=$(free --mega | awk '$1 == "Mem:" {print $2}')
ram_use=$(free --mega | awk '$1 == "Mem:" {print $3}')
ram_percent=$(free --mega | awk '$1 == "Mem:" {printf("%.2f"), $3/$2*100}')


free --mega: muestra memoria en MB

awk '$1 == "Mem:"': selecciona la lÃ­nea de memoria

$2: total

$3: usada

CÃ¡lculo del porcentaje con 2 decimales

ğŸ“Œ Resultado tÃ­pico:

Memory Usage: 512/2048MB (25.00%)

ğŸ’¾ DISCO
disk_total=$(df -m | grep "/dev/" | grep -v "/boot" | awk '{disk_t += $2} END {printf ("%.1fGb\n"), disk_t/1024}')
disk_use=$(df -m | grep "/dev/" | grep -v "/boot" | awk '{disk_u += $3} END {print disk_u}')
disk_percent=$(df -m | grep "/dev/" | grep -v "/boot" | awk '{disk_u += $3} {disk_t+= $2} END {printf("%d"), disk_u/disk_t*100}')


df -m: uso de disco en MB

grep "/dev/": solo discos reales

grep -v "/boot": excluye /boot

$2: tamaÃ±o total

$3: usado

Suma todas las particiones

Convierte a GB

ğŸ“Œ EvalÃºa todo el sistema, no una sola particiÃ³n

ğŸ”¥ CARGA DE CPU
cpul=$(vmstat 1 2 | tail -1 | awk '{printf $15}')
cpu_op=$(expr 100 - $cpul)
cpu_fin=$(printf "%.1f" $cpu_op)


vmstat 1 2: dos muestras, 1 segundo

tail -1: usa la Ãºltima (mÃ¡s precisa)

$15: porcentaje de CPU idle

100 - idle = CPU en uso

Formateo a 1 decimal

ğŸ“Œ Resultado: CPU load real

â±ï¸ ÃšLTIMO ARRANQUE
lb=$(who -b | awk '$1 == "system" {print $3 " " $4}')


who -b: muestra Ãºltimo boot

awk: extrae fecha y hora

ğŸ“¦ USO DE LVM
lvmu=$(if [ $(lsblk | grep "lvm" | wc -l) -gt 0 ]; then echo yes; else echo no; fi)


lsblk: lista discos

grep lvm: busca LVM

Si hay al menos uno â†’ yes

Si no â†’ no

ğŸ“Œ Esto es obligatorio en la defensa

ğŸŒ CONEXIONES TCP
tcpc=$(ss -ta | grep ESTAB | wc -l)


ss -ta: conexiones TCP

ESTAB: conexiones establecidas

Cuenta cuÃ¡ntas hay

ğŸ‘¤ USUARIOS LOGUEADOS
ulog=$(users | wc -w)


users: usuarios conectados

wc -w: cuenta palabras (usuarios)

ğŸŒ RED
ip=$(hostname -I)
mac=$(ip link | grep "link/ether" | awk '{print $2}')


hostname -I: IP del sistema

ip link: interfaces de red

link/ether: MAC address

ğŸ›¡ï¸ COMANDOS SUDO
cmnd=$(journalctl _COMM=sudo | grep COMMAND | wc -l)


journalctl: logs del sistema

_COMM=sudo: solo sudo

COMMAND: comandos ejecutados

Cuenta cuÃ¡ntos se han usado

ğŸ“Œ Muy importante para seguridad

ğŸ“¢ MOSTRAR INFORMACIÃ“N
wall " ..."


wall: envÃ­a mensaje a todos los usuarios conectados

Se ejecuta cada 10 minutos (cron)

Muestra el estado del sistema
